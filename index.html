<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Rituva â€“ Weather & AQI Intelligence</title>

<link rel="manifest" href="manifest.json" />
<meta name="theme-color" content="#0b1220" />

<style>
body {
  margin: 0;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
  background: #0b1220;
  color: #ffffff;
}

header {
  padding: 14px;
  text-align: center;
  font-size: 20px;
  font-weight: 600;
  background: #111a2e;
}

.container {
  padding: 14px;
  display: flex;
  flex-direction: column;
  gap: 14px;
}

.card {
  background: #111a2e;
  border-radius: 14px;
  padding: 14px;
}

.card h3 {
  margin: 0 0 10px;
  font-size: 15px;
  color: #9ecbff;
}

.search {
  display: flex;
  gap: 8px;
}

input {
  flex: 1;
  padding: 10px;
  border-radius: 10px;
  border: none;
  outline: none;
}

button {
  padding: 10px 14px;
  border-radius: 10px;
  border: none;
  background: #1f6fff;
  color: white;
  cursor: pointer;
}

.grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 10px;
}

.value {
  font-size: 20px;
  font-weight: 600;
}

.small {
  font-size: 12px;
  opacity: 0.8;
}

.full {
  grid-column: span 2;
}

.hidden {
  display: none;
}

footer {
  text-align: center;
  padding: 10px;
  font-size: 12px;
  opacity: 0.6;
}
</style>
</head>

<body>

<header>Rituva â€“ Weather & AQI Intelligence</header>

<div class="container">

  <!-- SEARCH -->
  <div class="card">
    <div class="search">
      <input id="cityInput" placeholder="Search cityâ€¦" />
      <button onclick="searchCity()">Search</button>
      <button onclick="useMyLocation()">ğŸ“</button>
    </div>
  </div>

  <!-- LOCATION CONDITIONS -->
  <div class="card" id="locationCard">
    <h3>ğŸ“ Location Conditions</h3>
    <div class="grid">
      <div>
        <div class="value" id="locName">â€”</div>
        <div class="small">Location</div>
      </div>
      <div>
        <div class="value" id="temp">â€”</div>
        <div class="small">Temperature (Â°C)</div>
      </div>
      <div>
        <div class="value" id="humidity">â€”</div>
        <div class="small">Humidity (%)</div>
      </div>
      <div>
        <div class="value" id="wind">â€”</div>
        <div class="small">Wind (m/s)</div>
      </div>
    </div>
  </div>

  <!-- AQI -->
  <div class="card">
    <h3>ğŸ“ˆ AQI Intelligence</h3>
    <div class="grid">
      <div>
        <div class="value" id="pm25">â€”</div>
        <div class="small">PM2.5</div>
      </div>
      <div>
        <div class="value" id="pm10">â€”</div>
        <div class="small">PM10</div>
      </div>
      <div class="full small" id="aqiStatus">Waiting for dataâ€¦</div>
    </div>
  </div>

  <!-- RAIN -->
  <div class="card">
    <h3>â˜” Rain Intelligence</h3>
    <div class="grid">
      <div>
        <div class="value" id="rain">â€”</div>
        <div class="small">Rain (mm)</div>
      </div>
      <div>
        <div class="value" id="clouds">â€”</div>
        <div class="small">Clouds (%)</div>
      </div>
    </div>
  </div>

  <!-- 24H -->
  <div class="card">
    <h3>ğŸŒ¡ Temperature (24H)</h3>
    <div class="small" id="temp24">Loadingâ€¦</div>
  </div>

  <!-- 7 DAY -->
  <div class="card">
    <h3>ğŸ“… 7-Day Temperature</h3>
    <div class="small" id="temp7">Loadingâ€¦</div>
  </div>

  <!-- POLAR MODE -->
  <div class="card">
    <h3>ğŸ§Š Polar Mode</h3>
    <button onclick="openPolar()">Open Polar Window</button>
  </div>

</div>

<footer>
Free open data Â· No API key Â· Â© Manik Roy 2026
</footer>

<script>
const WEATHER_API = "https://api.open-meteo.com/v1/forecast";
const AQI_API = "https://air-quality-api.open-meteo.com/v1/air-quality";
const GEO_API = "https://nominatim.openstreetmap.org/search";

function updateWeather(lat, lon, name="") {
  fetch(`${WEATHER_API}?latitude=${lat}&longitude=${lon}&current=temperature_2m,relative_humidity_2m,wind_speed_10m,cloud_cover&hourly=temperature_2m&daily=temperature_2m_max&timezone=auto`)
    .then(r=>r.json())
    .then(d=>{
      document.getElementById("locName").textContent = name || "Your Location";
      document.getElementById("temp").textContent = d.current.temperature_2m;
      document.getElementById("humidity").textContent = d.current.relative_humidity_2m;
      document.getElementById("wind").textContent = d.current.wind_speed_10m;
      document.getElementById("clouds").textContent = d.current.cloud_cover;
      document.getElementById("temp24").textContent = d.hourly.temperature_2m.slice(0,24).join(" Â°C , ");
      document.getElementById("temp7").textContent = d.daily.temperature_2m_max.join(" Â°C , ");
    });

  fetch(`${AQI_API}?latitude=${lat}&longitude=${lon}&hourly=pm10,pm2_5`)
    .then(r=>r.json())
    .then(d=>{
      const pm25 = d.hourly.pm2_5[0];
      const pm10 = d.hourly.pm10[0];
      document.getElementById("pm25").textContent = pm25;
      document.getElementById("pm10").textContent = pm10;
      document.getElementById("aqiStatus").textContent =
        pm25 < 50 ? "Good" : pm25 < 100 ? "Moderate" : "Poor";
    });
}

function searchCity() {
  const q = cityInput.value;
  fetch(`${GEO_API}?q=${q}&format=json`)
    .then(r=>r.json())
    .then(d=>{
      if (!d[0]) return alert("City not found");
      updateWeather(d[0].lat, d[0].lon, d[0].display_name);
    });
}

function useMyLocation() {
  navigator.geolocation.getCurrentPosition(
    pos => updateWeather(pos.coords.latitude, pos.coords.longitude),
    () => alert("Location permission denied")
  );
}

function openPolar() {
  window.open("https://api.open-meteo.com/v1/forecast?latitude=90&longitude=0&current=temperature_2m","_blank");
}

if ("serviceWorker" in navigator) {
  navigator.serviceWorker.register("sw.js");
}
</script>

</body>
</html>
