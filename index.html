<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Rituva Weather</title>
<meta name="theme-color" content="#000000">
<style>
:root{
--bg:#000;
--card:#1a1a1a;
--soft:#222;
--text:#fff;
--muted:#9a9a9a;
--radius:26px;
}
.light{
--bg:#f4f6f8;
--card:#fff;
--soft:#e8eaed;
--text:#111;
--muted:#666;
}
.oled{
--bg:#000;
--card:#000;
--soft:#000;
--text:#fff;
--muted:#777;
}
*{box-sizing:border-box}
body{
margin:0;
background:var(--bg);
color:var(--text);
font-family:-apple-system,BlinkMacSystemFont,system-ui;
}
.app{max-width:430px;margin:auto;padding:18px}
h1{font-size:34px;margin-bottom:14px}
h2{font-size:24px;margin:28px 0 14px}
button,input{
width:100%;
padding:16px;
margin-bottom:10px;
border:none;
border-radius:var(--radius);
background:var(--soft);
color:var(--text);
font-size:16px;
}
.grid{display:grid;grid-template-columns:1fr 1fr;gap:14px}
.card{
background:var(--card);
padding:18px;
border-radius:var(--radius);
text-align:center;
}
.card small{color:var(--muted)}
.card b{font-size:28px;display:block;margin-top:6px}
.full{grid-column:1/-1}
.hero{text-align:center;margin:18px 0}
.hero b{font-size:82px}
footer{
text-align:center;
color:var(--muted);
font-size:14px;
margin:40px 0 10px;
}
</style>
</head>

<body>
<div class="app">

<h1>ğŸŒ¦ï¸ Rituva</h1>

<button onclick="toggleTheme()">ğŸŒ— Light / Dark</button>
<button onclick="toggleOLED()">ğŸ–¤ OLED True Black</button>
<button onclick="toggleUnit()">ğŸŒ¡ Â°C / Â°F</button>

<input id="search" placeholder="Search city" onkeydown="if(event.key==='Enter')searchCity()">
<button onclick="searchCity()">Search</button>
<button onclick="useMyLocation()">ğŸ“ Use My Location</button>

<div class="hero">
<small id="city">My Location</small>
<b id="temp">--</b>
</div>

<h2>ğŸŒ¡ Temperature</h2>
<div class="grid">
<div class="card"><small>Today Min</small><b id="tmin">--</b></div>
<div class="card"><small>Today Max</small><b id="tmax">--</b></div>
<div class="card"><small>24h Min</small><b id="t24min">--</b></div>
<div class="card"><small>24h Max</small><b id="t24max">--</b></div>
<div class="card"><small>7-Day Min</small><b id="t7min">--</b></div>
<div class="card"><small>7-Day Max</small><b id="t7max">--</b></div>
</div>

<h2>ğŸŒ§ Rain & Monsoon</h2>
<div class="grid">
<div class="card"><small>Hourly Rain</small><b id="rain">--</b></div>
<div class="card"><small>24h Rain</small><b id="rain24">--</b></div>
<div class="card"><small>7-Day Rain</small><b id="rain7">--</b></div>
<div class="card"><small>Flood Probability</small><b id="flood">--</b></div>
<div class="card"><small>Monsoon Severity</small><b id="monsoon">--</b></div>
<div class="card"><small>Cyclone Alert</small><b id="cyclone">--</b></div>
</div>

<h2>ğŸŒ¬ Air Quality</h2>
<div class="grid">
<div class="card full"><small>PM2.5</small><b id="pm">--</b></div>
<div class="card"><small>Children</small><b id="child">--</b></div>
<div class="card"><small>Elderly</small><b id="old">--</b></div>
<div class="card"><small>Asthma</small><b id="asthma">--</b></div>
</div>

<h2>ğŸ”¥ Heat â€¢ Night â€¢ Power</h2>
<div class="grid">
<div class="card"><small>Heatwave Index</small><b id="heat">--</b></div>
<div class="card"><small>Night Discomfort</small><b id="night">--</b></div>
<div class="card full"><small>Power Demand</small><b id="power">--</b></div>
</div>

<h2>ğŸŒ… Sun</h2>
<div class="grid">
<div class="card full"><small>Sunrise / Sunset</small><b id="sun">--</b></div>
</div>

<h2>â„¹ï¸ Data Status</h2>
<div class="grid">
<div class="card full"><small>Last Updated</small><b id="updated">--</b></div>
</div>

<footer>Â© Manik Roy 2025. All Rights Reserved.</footer>

</div>

<script>
const $=id=>document.getElementById(id)
let UNIT=localStorage.unit||"C"
let lastData=null

function toTemp(c){return UNIT==="C"?`${c.toFixed(1)}Â°C`:`${((c*9/5)+32).toFixed(1)}Â°F`}

function toggleUnit(){UNIT=UNIT==="C"?"F":"C";localStorage.unit=UNIT;if(lastData)applyData(lastData);updateTimestamp()}

function toggleTheme(){document.body.classList.toggle("light");localStorage.theme=document.body.classList.contains("light")?"light":"dark"}
function toggleOLED(){document.body.classList.toggle("oled");localStorage.oled=document.body.classList.contains("oled")?"on":"off"}
if(localStorage.theme==="light")document.body.classList.add("light")
if(localStorage.oled==="on")document.body.classList.add("oled")

function updateTimestamp(){
const now=new Date()
$("updated").innerText=now.toLocaleDateString()+" "+now.toLocaleTimeString()
}

function aqiColor(pm){
if(pm<=50)return "#2ECC71";
if(pm<=100)return "#F1C40F";
if(pm<=150)return "#E67E22";
if(pm<=200)return "#E74C3C";
if(pm<=300)return "#8E44AD";
return "#7B241C";
}

function applyData({w,a}){
const t=w.hourly.temperature_2m[0]
$("temp").innerText=toTemp(t)

$("tmin").innerText=toTemp(w.daily.temperature_2m_min[0])
$("tmax").innerText=toTemp(w.daily.temperature_2m_max[0])

const t24=w.hourly.temperature_2m.slice(0,24)
$("t24min").innerText=toTemp(Math.min(...t24))
$("t24max").innerText=toTemp(Math.max(...t24))

$("t7min").innerText=toTemp(Math.min(...w.daily.temperature_2m_min))
$("t7max").innerText=toTemp(Math.max(...w.daily.temperature_2m_max))

const rain24=w.hourly.precipitation.slice(0,24).reduce((a,b)=>a+b,0)
$("rain").innerText=w.hourly.precipitation[0].toFixed(1)+" mm"
$("rain24").innerText=rain24.toFixed(1)+" mm"
$("rain7").innerText=(rain24*3).toFixed(1)+" mm"

$("flood").innerText=Math.min(100,Math.round(rain24*2))+"%"
$("monsoon").innerText=rain24>60?"Extreme":rain24>30?"Strong":"Normal"
$("cyclone").innerText=rain24>120?"Alert":"None"

const pm=a.hourly.pm2_5[0]
$("pm").innerText=Math.round(pm)+" Âµg/mÂ³"
$("pm").style.color = aqiColor(pm)
$("child").innerText=pm>75?"High":"Low"
$("child").style.color = aqiColor(pm)
$("old").innerText=pm>100?"High":"Moderate"
$("old").style.color = aqiColor(pm)
$("asthma").innerText=pm>60?"High":"Low"
$("asthma").style.color = aqiColor(pm)

$("heat").innerText=t>=40?"Severe":t>=35?"High":"Normal"
$("night").innerText=t>=30?"Uncomfortable":"Normal"
$("power").innerText=t>=35?"Peak Load":"Normal"

$("sun").innerText=w.daily.sunrise[0].slice(11,16)+" / "+w.daily.sunset[0].slice(11,16)

updateTimestamp()
}

async function load(lat,lon,name){
$("city").innerText=name
try{
const w=await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&hourly=temperature_2m,precipitation&daily=temperature_2m_min,temperature_2m_max,sunrise,sunset&timezone=auto`).then(r=>r.json())
const a=await fetch(`https://air-quality-api.open-meteo.com/v1/air-quality?latitude=${lat}&longitude=${lon}&hourly=pm2_5`).then(r=>r.json())
lastData={w,a}
applyData(lastData)
}catch{ $("temp").innerText="Offline" }
}

function useMyLocation(){
navigator.geolocation.getCurrentPosition(
p=>load(p.coords.latitude,p.coords.longitude,"My Location"),
()=>load(22.57,88.36,"Kolkata")
)
}
async function searchCity(){
if(!search.value)return
const g=await fetch(`https://geocoding-api.open-meteo.com/v1/search?name=${search.value}&count=1`).then(r=>r.json())
if(g.results)load(g.results[0].latitude,g.results[0].longitude,g.results[0].name)
}

useMyLocation()
</script>

</body>
</html>
